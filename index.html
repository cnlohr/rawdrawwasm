 <!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Test</title>
	</head>
	<body>
		<canvas width=200px height=200px id=canvas></canvas>
		<script>

var blob = atob('AGFzbQEAAAABLQlgAX8AYAJ/fwBgAABgBH9/f38AYAF8AXxgBH19fX8AYAABf2ABfwF/YAABfAKb \
Ag4DZW52FkNORkdDbGVhckZyYW1lSW50ZXJuYWwAAANlbnYNQ05GR1RhY2tQaXhlbAABA2Vudg9D \
TkZHVGFja1NlZ21lbnQAAwNlbnYJQ05GR0NvbG9yAAcDZW52EU9HR2V0QWJzb2x1dGVUaW1lAAgD \
ZW52E0NORkdTZXR1cEZ1bGxzY3JlZW4AAQNlbnYPQ05GR0hhbmRsZUlucHV0AAIDZW52EUNORkdH \
ZXREaW1lbnNpb25zAAEDZW52EUNORkdUYWNrUmVjdGFuZ2xlAAMDZW52DENORkdUYWNrUG9seQAB \
A2Vudg9DTkZHU3dhcEJ1ZmZlcnMAAgNlbnYDY29zAAQDZW52A3NpbgAEA2VudgZtZW1vcnkCAAID \
BwYGAAUAAgAGEgN/AUHQ6QQLfwFBAAt/AUEACwdmBQRtYWluAA0VYXN5bmNpZnlfc3RhcnRfdW53 \
aW5kABAUYXN5bmNpZnlfc3RvcF91bndpbmQAERVhc3luY2lmeV9zdGFydF9yZXdpbmQAEhRhc3lu \
Y2lmeV9zdG9wX3Jld2luZAARCuMoBuAiAxF/DH0GfCMBQQJGBEAjAiMCKAIAQex+ajYCACMCKAIA \
IgIoAgAhACACKAIEIQEgAioCCCERIAIoAhAhBCACKgIUIRIgAigCGCEFIAIqAhwhEyACKwIgIR0g \
AigCKCEHIAIqAiwhFSACKAIwIQggAigCNCEJIAIqAjghFyACKgI8IRYgAigCQCEKIAIrAkQhHiAC \
KgJMIRggAisCUCEgIAIoAlghCyACKgJcIRQgAigCYCEMIAIqAmQhGSACKwJoISEgAigCcCENIAIo \
AnQhDiACKgJ4IRogAigCfCEPIAIqAoABIRsgAioChAEhHCACKAKIASEQIAIrAowBISIgAigCDCEC \
CwJ/IwFBAkYEQCMCIwIoAgBBfGo2AgAjAigCACgCACEGCyMBRQRAIwAiAEGgAWsiASQACyAGRUEB \
IwEbBEAQBEEAIwFBAUYNARohHQsgBkEBRkEBIwEbBEAQBEEBIwFBAUYNARohHQsjAUUEQEGQF0EB \
OgAACyAGQQJGQQEjARsEQEGACEEAEAVBAiMBQQFGDQEaCyMBRQRAA0AgCbIhF0EAIQIDQCACsiEV \
QwAAAAAhEkEAIQhBBCEHA0ACfyAXQQEgB3SyIhaVIhSLQwAAAE9dBEAgFKgMAQtBgICAgHgLIQAg \
FCAAspMiFCAUlCERRAAAAAAAAPA/IBQgEZQiEUMAACBBlCAUIBGUQwAAcEGUkyAUIBQgEUMAAMBA \
lJSUkiITu6EhHSAAQbnnAGwiA0G3/vkPaiEFAn8gFSAWlSIUi0MAAABPXQRAIBSoDAELQYCAgIB4 \
CyEAIBQgALKTIhEgEZQhFiASIhREAAAAAAAA8D8gESAWlCISQwAAIEGUIBEgEpRDAABwQZQiGJMi \
FiARIBEgEkMAAMBAlJSUkiISu6EgHSAAIAVsQc3IAG+3RAAAAAAAJrJAo0QAAAAAAADwv6C2u6Ig \
EyADQfDl+g9qIgQgAGxBzcgAbyIKt0QAAAAAACayQKNEAAAAAAAA8L+gtpS7IiGgtruiIh4gEiAd \
IAUgAEEBaiIAbEHNyABvIgW3RAAAAAAAJrJAo0QAAAAAAADwv6C2u6IgEyAAIARsQc3IAG+3RAAA \
AAAAJrJAo0QAAAAAAADwv6C2lLsiIKC2lLugIh22QQIgCHSylZIhEiAHQX9qIQcgCEEBaiIIQQVH \
DQALIAkgAkEobGpBAnRBoBdqIBJDAAAAQZQiETgCACACQQFqIgJBKEcNAAsgCUEBaiIJQShHDQAL \
IAFB+ABqIQ0gAUHgAGoiAEEEciEOIAFBzABqIQ8gAUGQAWohDAsDQCMBRQRAQaDJAEGgyQAoAgBB \
AWoiADYCAAsgBkEDRkEBIwEbBEAQBkEDIwFBAUYNAhoLIwFFBEBBgICABEEAQZAXLQAAGyEACyAG \
QQRGQQEjARsEQCAAEABBBCMBQQFGDQIaCyAGQQVGQQEjARsEQEH///8HEANBBSMBQQFGDQIaIQAL \
IAZBBkZBASMBGwRAQaTJAEGmyQAQB0EGIwFBAUYNAhoLIwFFBEBBtMkAQYCAgPx7NgIAQbjJAEGA \
gID8AzYCAEHU2QBCADcCAEHc2QBCADcCAEHo2QBCADcDAEHk2QBBrK2/gQQ2AgBB8NkAQgA3AwBB \
iNoAQoCAgPwLNwMAQYDaAEIANwMAQfjZAELJwYD8++C5pr5/NwMAQdDJAEGAgID8AzYCAEHUyQBC \
ADcCAEHcyQBCADcCAEGgyQBBoMkAKAIAIgBBAWo2AgBBvMkAQaTJAC4BALIiEUMAAAA/lDgCAEHA \
yQBBpskALgEAsiISQwAAAL+UOAIAQdDZAEOs1i9AIBEgEpWVOAIAQejJAEIANwMAQeTJAEGAgID8 \
AzYCAEHwyQBCADcDAEH4yQBBgICA/AM2AgBB/MkAQgA3AgBBhMoAQgA3AgBBjMoAQYCAgPwDNgIA \
IA5BCGoiB0IANwIAIA1CADcDACANQQhqIgVCADcDACAOQgA3AgAgDEIANwMAIAxBCGoiAkEANgIA \
IAFBgICA/AM2AmAgAUGAgID8AzYCdCABQYCAgPwDNgKcASABQoCAgPyDgICQQjcDiAEgAUEANgJs \
IAFBADYCfCABQeAAahAOIA9CADcCACAPQQhqIgRCADcCACABQQA2AjwgAUEANgIsIAFBgICA/AM2 \
AlwgAEGQHHAiALhEAAAAAAAAJECjtiIRu0Rw4g2lRd+RP6IhHQsgBkEHRkEBIwEbBEAgHRALQQcj \
AUEBRg0CGiEeCyAGQQhGQQEjARsEQCAdEAxBCCMBQQFGDQIaIR0LIwFFBEAgAUMAAIA/QwAAAAAg \
HbaTIhcgF5RDAAAAACAetpMiFSAVlJJDAACAP5KRlSISOAJIIAEgFSASlCIRjDgCRCABIBcgEpQi \
E4w4AkAgASASQwAAAICUIhggE5MiFjgCJCABIBEgGJMiGDgCICABIBEgGJQgEyAWlJM4AjggASAT \
QwAAAACUIBFDAAAAAJSTIhk4AiggASATIBmUIBIgGJQiE5I4AjQgASAWIBKMlCARIBmUIhKTIhE4 \
AjAgAUEgahAOIAdCADcCACANQgA3AwAgBUIANwMAIA5CADcCACAMQgA3AwAgAkEANgIAIAFBgICA \
/AM2AmAgAUGAgID8AzYCdCABQYCAgPwDNgKcASABQoCAgPyDgIDAv383A4gBIAEgFzgCbCABIBU4 \
AnwgAUHgAGoiABAOQQAhCkGgFyEJCwNAIwFFBEBBbCEIIApBbGoiALIiEkMAAIA/kiETIBIgE5Mh \
FyAKQQFqIQpBACEHCwNAIwFFBEAgASASOAJgIAEgCLIiETgCZCAHIAlqIgAoAgAhBSABIBE4AiQg \
ASATOAIgIAEgBTYCaCAAQQRqKAIAIQIgASARQwAAgD+SIhU4AhggASASOAIUIAEgAjYCKCAAQaAB \
aigCACEEIAEgFTgCDCABIBM4AgggASAENgIcIAEgAEGkAWooAgAiADYCECASIBEgBb4iGCABQeAA \
aiILEA8gEyARIAK+IhYgAUEgahAPIBIgFSAEviIZIAFBFGoiAhAPIBMgFSAAviABQQhqEA8gASoC \
aCIaQwAAgD9gIQALAkAjAUUEQCAADQEgASoCKCIUQwAAgD9gIgANASABKgIcIhtDAACAP2AiAA0B \
IAEqAhAiHEMAAAAAXSIADQEgG0MAAAAAXSIADQEgFEMAAAAAXSIADQEgGkMAAAAAXSIADQEgHEMA \
AIA/YCIADQECfyAXIBEgEZMiGpQgFyAVIBGTIhGUkyARIBggFpMiEZQgGiAZIBaTIhWUIhaTIBcg \
FZQiFSAXIBGUk5OSQwAAAACXQwAASEKUIhGLQwAAAE9dBEAgEagMAQtBgICAgHgLIQALIAZBCUZB \
ASMBGwRAIAAQA0EJIwFBAUYNBRohAAsjAUUEQAJ/IAEqAiQiEYtDAAAAT10EQCARqAwBC0GAgICA \
eAshBAJ/IAEqAiAiEYtDAAAAT10EQCARqAwBC0GAgICAeAshAgJ/IAEqAmQiEYtDAAAAT10EQCAR \
qAwBC0GAgICAeAshAAJ/IAEqAmAiEYtDAAAAT10EQCARqAwBC0GAgICAeAshBQsgBkEKRkEBIwEb \
BEAgBSAAIAIgBBACQQojAUEBRg0FGgsjAUUEQAJ/IAEqAhgiEYtDAAAAT10EQCARqAwBC0GAgICA \
eAshBCAFIQICfyABKgIUIhGLQwAAAE9dBEAgEagMAQtBgICAgHgLIQsLIAZBC0ZBASMBGwRAIAIg \
ACALIAQQAkELIwFBAUYNBRoLCyMBRQRAIAhBAWohCCAHQaABaiIHQeAwRyIADQELCyMBRQRAIAlB \
BGohCSAKQSdHIgANAQsLIAZBDEZBASMBGwRAQcSIkQIQA0EMIwFBAUYNAhohAAsgBkENRkEBIwEb \
BEBBAEEAQYQCQYQCEAhBDSMBQQFGDQIaCyMBRQRAQazJAEEKNgIAQajJAEEKNgIACyAGQQ5GQQEj \
ARsEQEH///8HEANBDiMBQQFGDQIaIQALIwFFBEAgAUEAOwFgQQAhAgsDQCMBRQRAQazJACACQfD/ \
//8HcUEFciIANgIAQajJACACQQR0QfABcSIEQQVyIgk2AgAgASACOgBgIACyIRIgCbIhEUEAIQsg \
AiEACwNAAkAjAUUEQCAAQf8BcSIAQQpLIQQLAn0jAUUEQAJAIAQNAAJAAkAgAEEBayIEDgoCAgIC \
AgICAgABBQsgEUMAAMBBkgwDCyASQwAAQEGSIRJBqMkAKAIAIgCyDAILIABBAXRBkAhqLwEAIgBB \
//8DRyEECyAEIwFBAkZyBEAjAUUEQCAAQZAMaiEIQQEhBAsDQCMBRQRAIAUhACAHIQkCfyASIAgt \
AAAiCkEBdEEOcbKSIhOLQwAAAE9dBEAgE6gMAQtBgICAgHgLIQUgBEH/AXEhBAJ/IBEgCkEDdiIQ \
QQ5xspIiE4tDAAAAT10EQCATqAwBC0GAgICAeAshBwsCQCAEIwFBAkZyBEAjAUUEQCAKQQhxRSIA \
DQILIAZBD0ZBASMBGwRAIAcgBRABQQ8jAUEBRg0KGgsjAUUNAQsjAUUEQCAJQRB0QRB1IQQgAEEQ \
dEEQdSEACyAGQRBGQQEjARsEQCAEIAAgByAFEAJBECMBQQFGDQkaCwsjAUUEQCAIQQFqIQggEEEB \
cSEEIApBgAFxRSIADQELCwsgESARQwAAwECSIwEbCyERIwFFBEAgC0EBaiILIAFB4ABqai0AACEA \
DAILCwsjAUUEQCACQQFqIgJBgAJHIgANAQsLIwFFBEBBqMkAQQA2AgBBrMkAQQA2AgBBACEACwNA \
IAZBEUZBASMBGwRAQYD+AxADQREjAUEBRg0DGiEFCyMBRQRAQaDJACgCACAAaiIFsyIRu0R7FK5H \
4XqEP6IhHSABIQILIAZBEkZBASMBGwRAIB0QC0ESIwFBAUYNAxohIAsjAUUEQCACAn8gIEQAAAAA \
AAA+QKIgACAAQf//A3FBFHAiBWu3IiGgIh6ZRAAAAAAAAOBBYwRAIB6qDAELQYCAgIB4CyIEOwFq \
IAEhAgsgBkETRkEBIwEbBEAgHRAMQRMjAUEBRg0DGiEdCyMBRQRAIAICfyAdRAAAAAAAACRAoiAF \
QR5styIeoCIimUQAAAAAAADgQWMEQCAiqgwBC0GAgICAeAs7AWggAQJ/ICBEAAAAAAAASUCiICGg \
IiCZRAAAAAAAAOBBYwRAICCqDAELQYCAgIB4CyIIOwFmIAECfyAdRAAAAAAAADRAoiAeoCIgmSIh \
RAAAAAAAAOBBYwRAICCqDAELQYCAgIB4CzsBZCABIAg7AWIgAQJ/IB1EAAAAAAAASUCiIB6gIh2Z \
Ih5EAAAAAAAA4EFjBEAgHaoMAQtBgICAgHgLIgI7AWAgAUHgAGohBQsgBkEURkEBIwEbBEAgBUED \
EAlBFCMBQQFGDQMaCyMBRQRAIABBAWoiAEGQA0ciBQ0BCwsjAUUEQEGwyQBBsMkAKAIAQQFqIgA2 \
AgALIAZBFUZBASMBGwRAEApBFSMBQQFGDQIaCyMBRQ0ACwALIQMjAigCACADNgIAIwIjAigCAEEE \
ajYCACMCKAIAIgMgADYCACADIAE2AgQgAyAROAIIIAMgAjYCDCADIAQ2AhAgAyASOAIUIAMgBTYC \
GCADIBM4AhwgAyAdOQIgIAMgBzYCKCADIBU4AiwgAyAINgIwIAMgCTYCNCADIBc4AjggAyAWOAI8 \
IAMgCjYCQCADIB45AkQgAyAYOAJMIAMgIDkCUCADIAs2AlggAyAUOAJcIAMgDDYCYCADIBk4AmQg \
AyAhOQJoIAMgDTYCcCADIA42AnQgAyAaOAJ4IAMgDzYCfCADIBs4AoABIAMgHDgChAEgAyAQNgKI \
ASADICI5AowBIwIjAigCAEGUAWo2AgBBAAuKAgEFfyMAQUBqIgEhAwNAIAMgBUECdCICQTBxIgRB \
0MkAaioCACACQQxxIgIgAGoqAgCUQwAAAACSIARBBHJB0MkAaioCACACQRByIABqKgIAlJIgBEEI \
ckHQyQBqKgIAIAJBIHIgAGoqAgCUkiAEQQxyQdDJAGoqAgAgAkEwciAAaioCAJSSOAIAIANBBGoh \
AyAFQQFqIgVBEEcNAAtB0MkAIAEoAgA2AgBB1MkAIAEpAgQ3AgBB3MkAIAEpAgw3AgBB5MkAIAEp \
AhQ3AgBB7MkAIAEpAhw3AgBB9MkAIAEpAiQ3AgBB/MkAIAEpAiw3AgBBhMoAIAEpAjQ3AgBBjMoA \
IAEoAjw2AgALqAMBC31B7NkAKgIAIQdB6NkAKgIAIQhB4NkAKgIAIQlB5NkAKgIAIQpB/NkAKgIA \
IQtB+NkAKgIAIQxB8NkAKgIAIQ1B9NkAKgIAIQ4gA0G8yQAqAgBB3MkAKgIAQdDJACoCACAAlEHU \
yQAqAgAgAZSSQdjJACoCACAClJKSIgRB0NkAKgIAlEHsyQAqAgBB4MkAKgIAIACUQeTJACoCACAB \
lJJB6MkAKgIAIAKUkpIiBUHU2QAqAgCUkkH8yQAqAgBB8MkAKgIAIACUQfTJACoCACABlJJB+MkA \
KgIAIAKUkpIiBkHY2QAqAgCUkkGMygAqAgBBgMoAKgIAIACUQYTKACoCACABlJJBiMoAKgIAIAKU \
kpIiAEHc2QAqAgCUkiAEQYDaACoCAJQgBUGE2gAqAgCUkiAGQYjaACoCAJSSIABBjNoAKgIAlJIi \
AZVBtMkAKgIAk5Q4AgAgAyAEIA2UIAUgDpSSIAYgDJSSIAAgC5SSIAGVOAIIIAMgBCAJlCAFIAqU \
kiAGIAiUkiAAIAeUkiABlUG4yQAqAgCTQcDJACoCAJQ4AgQLGQBBASQBIAAkAiMCKAIAIwIoAgRL \
BEAACwsVAEEAJAEjAigCACMCKAIESwRAAAsLGQBBAiQBIAAkAiMCKAIAIwIoAgRLBEAACwsLlQ8B \
AEGACAuND1Rlc3QgQmVuY2gAAAAAAAD//wAACAAQABgAHwApADIAMwD/////OQBCAP//SwBTAFwA \
YABkAGwAcgB7AIQAiQCTAJgAngCjAKkArACyALYA//+6AL0AwQDJANEA2QDiAOQA6ADsAPQA+AD6 \
APwA/QD/AAUBCgEQARYBGwEhAScBLAE1ATwBPgFBAUQBSAFLAVEBWQFgAWoBcAF3AX4BhAGMAZIB \
mAGdAaYBqQGuAbMBugHBAcoB0gHYAdwB4AHlAewB9AH7AQACBAIGAgoCDQIPAhECGAIdAiICJwIt \
AjQCPAJCAkUCSgJRAlMCXAJiAmcCbQJzAngCfgKCAogCjQKUApgCngKiAqgCrAKyArYC//////// \
//////////////////////////////////////////////////////////////////////////// \
/7wCvwLHAs4C2wLkAugC8gL0AvgC/gIEAwcDCQMRAxMDGAMeAyMDKwMtAzQDOwM8Az8DQQNGA0wD \
VQNeA2oDcAN5A4IDjAOXA6ADqwO3A8ADyQPSA9wD5QPtA/UD/gMGBA8EFwQeBCUELgQ3BD4EQgRL \
BFEEVwReBGQEbQR0BH4EhwSQBJoEpQSuBLkExgTPBNcE3wToBPAE9AT4BP0EAQUKBRQFGwUiBSoF \
MwU6BT4FRQVNBVUFXgVmBW4FdQX//wAJICkDIxSLAAkgKQQkE4wBISMUAwkRmhEiIxQDApkBISMJ \
AykDCRKcAysTHCMiEQKLmhoBISMDiQMhKiEZAxQjmgEQIRIJEhwDqwIDGwIaExCpASsDKQIRIhOK \
ACIEiCACJKgBECkQFAsUqwALDCArrAAoAAIqEBwgrAEhIwMJIBAUjAMjJASLARApEBQLFCsErAEY \
IRCcAxwjHBCcAiIZIpsCKgIZApsBAqoCIhECE6oRIgKZAhMiihAbnBAJIJkQHCAsASkDqyEQASMU \
CxCcAAkjLAQDIaghEAESAxQrAqwQmRABA5wQISOcASsRGyELAqoCKhGbBJsCqpwDqQAgJAQImgEQ \
HASsARAhIgSsACAkDBKqAAIqIKwgAAIiJIwgAiIkBIoAICESnAAMACAsBCwCqgACIiAIIowZmxkT \
jCACrAEpA6sAIowBECESG5whAQQkIhITqwQBECEsAqoABBQjEgoSIRCIIxQDARCpABAhIxQEiAAE \
LAAoApoADAAoApohEAEDFCMimgAMICwCqgAoEBwErAAgIxSLAAwCEiEoEiOsAASsBAARIKwEACog \
rAEQISMUA4kADAAQIRKKARAhIxQDCQSbAAwAECESAqwhEAEjFIsAKBCcAAQkqAADFCOoAAQsFBsk \
qAABIywEAyGoAAESHBIhqAAgAgSsEAAEnAGrECAknAEQqQSsAJkCBCQqIxKKAAQkIookBAMSqiAk \
BAKqJAQCIiObBAkCGgEQqSMSAxQjJBWMAAwDEiOsGRKcKiMkFYwADAMTKhOsEJwCDAIbEhwSI6wC \
DAMSI6wCIiQEigINBCQiigIELCUiigIMAxKqIgIDIySMERwCqgIEFCskqgIDFCOqAgMUGhMkqgIs \
BKoCAxwiI40CIgSsIBAULBKKEBkTnAAQFAwSqgEQEagDBCQjEosYEZwhEAECEyoQmxEABCQrApoB \
ChEpIisDGwIRIhOKABEoERwCKgOrEBoTnSAAAhEqAhMiJIwIqCAQEakQKSAhEZgRAhshEqsBIaoS \
qhAgIRkSGBGqAKgBECESiQIqERsDqwEQIQOrARAhEgoSI4sRqAINBBQrIqwUEAEaECCsmhQVjSCp \
ECAhEZgBEgsRIpsACQIoEhMrIqwACQIoEiITFKwAEBEJEQIoEhMrIqwYERIDFKsEAhEiLAMrEKkE \
AhEiLAMrAZgEAhEiLAMrARCpBAIRIiwDKwEQEagEAhEiLAMrCKgEAhEiLAMrACARiAAMAioAGRAc \
ECgUrCMUAwEQKRQVjQIqAgQsAxsAmQIqAgQsAxsRqAIqAgQsAxsBEKkCKgIELAMbCKgCKhIcBCwA \
mQIqEhwELBGoAioSHAQsARCpAioSHAQsKIgAECEjFAQIApoEAiQqARARqAIiJAQKAJkCIiQEChGo \
AiIkBAoRKACZAiIkBAoBEBGoASEkBAkIqAErA6kBECEjFAMJA6kBBCQpEagBBCQpAJkCBCQqARCp \
AQQkKQioAQITHBMiKRGoAAwBESITiwANABAhGgIiJIwCBCQqIxIKAJkCBCQqIxIKEagCBCQqIxIK \
ARCpAgQkKiMSCgEQEagCBCQqIxIKCakCBCQqIxIKARAhiQIbAgQsEhwSKhMrIqsDBCwDEioUFY0k \
BAIiIxsAmSQEAiIjGxGoJAQCIiMbARCpJAQCIiMbCakSHACZEhwRqBIcARCpEhwJqQAqESgCIiQE \
igIMAxIjLAEQEagCBCQiCgCZAgQkIgoRqAIEJCIKARCpAgQkIgoBEBGoAgQkIgoJqRkCKpsCBCQi \
CgSqAgQUKyQqAJkCBBQrJCoRqAIEFCskKgEQqQIEFCskKgmpAgMcIiMNEagADAIRIhOKAgMcIiMN \
CakALwlwcm9kdWNlcnMBDHByb2Nlc3NlZC1ieQEFY2xhbmcPMTAuMC4wLTR1YnVudHUx');
var memory = new WebAssembly.Memory({initial:2});
var HEAP8 = new Int8Array(memory.buffer);
var HEAPU8 = new Uint8Array(memory.buffer);
var HEAP16 = new Int16Array(memory.buffer);
var HEAPU16 = new Uint16Array(memory.buffer);
var HEAP32 = new Uint32Array(memory.buffer);
var HEAPU32 = new Uint32Array(memory.buffer);
var HEAPF32 = new Float32Array(memory.buffer);
var HEAPF64 = new Float64Array(memory.buffer);

let toUtf8Decoder = new TextDecoder( "utf-8" );
function toUTF8(ptr) {
	var len = 0|0; ptr |= 0;
	for( var i = ptr; HEAPU8[i] != 0; i++) len++;
	return toUtf8Decoder.decode(HEAPU8.subarray(ptr, ptr+len));
}

function rdColorToCSS( color )
{
	return "rgb( " + (color & 0xff) + ", " + ((color>>8) & 0xff) + ", " + ((color>>16) & 0xff) + " )";
}


var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
var fullscreen = false;

let wasmExports;
const DATA_ADDR = 16; // Where the unwind/rewind data structure will live.
let sleeping = false;

const imports = {
	env: {

		CNFGTackSegment: (x1, y1, x2, y2) => {
			ctx.beginPath();
			ctx.moveTo(x1+0.5, y1+0.5);
			ctx.lineTo(x2+0.5, y2+0.5);
			ctx.stroke();
		},
		CNFGTackPixel : (x1, y1 ) => {
			ctx.fillRect(x1|0, y1|0,1,1);
		},
		CNFGTackRectangle : (x1, y1, x2, y2) => {
			x1 |= 0; y1 |= 0; x2 |= 0; y2 |= 0;
			ctx.fillRect(x1, y1, x2-x1, y2-y1);
		},
		CNFGColor : (color) => {
			var strcol = rdColorToCSS( color );
			ctx.strokeStyle = strcol;
			ctx.fillStyle = strcol;
		},
		CNFGSetup : (title,w,h ) => {
			document.title = toUTF8( title );
			canvas.width = w;
			canvas.height = h;
			ctx.imageSmoothingEnabled = false;
			fullscreen = false;
		},
		CNFGSetupFullscreen : (title,w,h ) => {
			document.title = toUTF8( title );
			canvas.width = w;
			canvas.height = h;
			ctx.imageSmoothingEnabled = false;
			document.style += "overflow: hidden; width=100%; height=100%";
			canvas.style = "position:absolute; top:0; left:0;"
			fullscreen = true;
		},
		CNFGClearFrameInternal: ( color ) => {
			ctx.fillStyle = rdColorToCSS( color );
			ctx.rect(0, 0, canvas.width, canvas.height);
			ctx.fill();
		},
		CNFGTackPoly: (vertices, numverts) => {
			var i = 0 | 0;
			numverts |= 0;
			vertices |= 0;
			if( numverts < 1 ) return;
			ctx.beginPath();
			ctx.moveTo(HEAP16[vertices>>1], HEAP16[(vertices>>1)+1] );
			vertices += 4;
			for( i = 1; i < numverts; i++ )
			{
				ctx.lineTo(HEAP16[vertices>>1], HEAP16[(vertices>>1)+1] );
				vertices += 4;
			}
			ctx.closePath();
			ctx.fill();
		},
		CNFGGetDimensions: (pw, ph) => {
			HEAP16[pw>>1] = canvas.width;
			HEAP16[ph>>1] = canvas.height;
		},
		CNFGHandleInput: () => {
		},
		CNFGSwapBuffers: () => {
			if (!sleeping) {
				// We are called in order to start a sleep/unwind.
				// Fill in the data structure. The first value has the stack location,
				// which for simplicity we can start right after the data structure itself.
				HEAP32[DATA_ADDR >> 2] = DATA_ADDR + 8;
				// The end of the stack will not be reached here anyhow.
				HEAP32[DATA_ADDR + 4 >> 2] = 1024;
				wasmExports.asyncify_start_unwind(DATA_ADDR);
				sleeping = true;
				// Resume after the proper delay.
				requestAnimationFrame(function() {
					if( fullscreen )
					{
						canvas.width = window.innerWidth;
						canvas.height = window.innerHeight;
					}

					wasmExports.asyncify_start_rewind(DATA_ADDR);
					// The code is now ready to rewind; to start the process, enter the
					// first function that should be on the call stack.
					wasmExports.main();
				});
			} else {
				// We are called as part of a resume/rewind. Stop sleeping.
				wasmExports.asyncify_stop_rewind();
				sleeping = false;
			}
		},
		Add1 : (i) => { return i+1; },
		sin : Math.sin,
		cos : Math.cos,
		tan : Math.tan,
		sinf : Math.sin,
		cosf : Math.cos,
		tanf : Math.tan,
		OGGetAbsoluteTime : () =>
		{
			return new Date().getTime()/1000.;
		},
		OGUSleep: (us) => {
			if (!sleeping) {
				// We are called in order to start a sleep/unwind.
				//console.log('sleep...');
				// Fill in the data structure. The first value has the stack location,
				// which for simplicity we can start right after the data structure itself.
				HEAP32[DATA_ADDR >> 2] = DATA_ADDR + 8;
				// The end of the stack will not be reached here anyhow.
				HEAP32[DATA_ADDR + 4 >> 2] = 1024;
				wasmExports.asyncify_start_unwind(DATA_ADDR);
				sleeping = true;
				// Resume after the proper delay.
				setTimeout(function() {
					wasmExports.asyncify_start_rewind(DATA_ADDR);
					// The code is now ready to rewind; to start the process, enter the
					// first function that should be on the call stack.
					wasmExports.main();
				}, us/1000);
			} else {
				// We are called as part of a resume/rewind. Stop sleeping.
				wasmExports.asyncify_stop_rewind();
				sleeping = false;
			}
		},
		memory: memory,
		print: console.log,
		draw: () => {},
		printc: (str, len) => { console.log(utf8decoder.decode(HEAPU8.subarray(str, str+len))) },
	}
};


	var array = new Uint8Array(new ArrayBuffer(blob.length));
	var i = 0|0;
	for(i = 0; i < blob.length; i++) {
		array[i] = blob.charCodeAt(i);
	}

	console.log( imports );
	WebAssembly.instantiate(array, imports).then(
		function (wa)
		{
			instance = wa.instance;
			wasmExports = instance.exports;
			instance.exports.main();
		}
	);

		</script>
	</body>
</html>
